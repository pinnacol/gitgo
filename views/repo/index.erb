<h1>Gitgo Repo</h1>

<dl>
<dt>Path</dt>
<dd><%= repo.path %></dd>
<dt>Branch</dt>
<dd><%= repo.branch %></dd>
<dt>Commit</dt>
<dd><% if current %>
<%= erb :_commit, :locals => {:commit => repo.current }, :views => path('views/code'), :layout => false %><% else %>
  <em>The branch doesn't exist.  Click setup to initialize the branch.</em>
  
  <form action="<%= url('/repo/setup') %>" method="post">
    <dl>
    <dt><label for="remote">Track</label></dt>
    <dd>
      <select id="remote" name="remote">
      <option value="">None</option><% remotes.each do |remote| %>
      <option value="<%= remote %>" <% if track == remote || remote == "origin/gitgo" %> selected="true"<% end %>><%= remote %></option><% end %>
      </select>
    </dd>
    <dt><input type="submit" value="Setup" /></dt>
    <dd></dd>
    </dl>
  </form>
<% end %>
</dd>
<dt>Update</dt>
<dd>
  <form action="<%= url('/repo/update') %>" method="post">
    <dl>
    <dt><label for="remote">Remote</label></dt>
    <dd>
      <select id="remote" name="remote"><% remotes.each do |remote| %>
      <option value="<%= remote %>" <% if track == remote || remote == "origin/gitgo" %> selected="true"<% end %>><%= remote %></option><% end %>
      </select>
    </dd>
    <dt><label for="pull">Pull</label></dt>
    <dd><input id="pull" type="checkbox" name="pull" value="true" /></dd>
    <dt><label for="push">Push</label></dt>
    <dd><input id="push" type="checkbox" name="push" value="true" /></dd>
    <dt><input type="submit" value="Update" /></dt>
    <dd></dd>
    </dl>
  </form>
</dd>
<dt>Index</dt>
<dd>
  <ul><% keys.each do |key| %>
  <li><a href="<%= url "/repo/idx/#{key}" %>"><%= key %></a></li><% end %>
  </ul>
  
  <form action="<%= url('/repo/reindex') %>" method="post">
    <input type="hidden" name="full" value="true" />
    <input type="submit" value="Reindex" />
  </form>
</dd>
</dl>

<ul>
<li><a href="<%= url('/repo/status') %>">Status</a></li>
<li><a href="<%= url('/repo/maintenance') %>">Maintenance</a></li>
<li><a href="<%= url('/repo/design') %>">Reference</a></li>
</ul>
